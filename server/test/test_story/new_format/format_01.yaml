################################################
# date: 2018/4/20
# spec: simplify the testcase
# author: x-lab.Leo
################################################

---
schema:
  steps:
    -
      id: 1
      name: set-up-zabbix-agent
      type: test
      action: setUp
      service:
        name: monitor-service-A
        interface: prepare-agent
      args:
        target: cxt.hosts

    -
      id: 2
      name: start-to-monitor
      type: test
      action: start
      service:
        name: monitor-service-A
        interface: monitor-param-start
      args:
        target: cxt.hosts
        properties:
          - cpu-health
          - mem-usage
          - io-rate

    -
      id: 3
      name: simulate-mass-call
      type: test
      action: start
      service:
        name: clearwater-workload-service
        interface: simulate-call
      args:
        cassandra:
          host: cxt.cassandra
          user-number: 20000
        sprout:
          host: cxt.sprout
          user-number: 20000
          time: 100min
          initial-reg-rate: 100
          icscf-target: 10.42.56.48:5052
          scscf-target: 10.42.56.48:5054 
    
    -
      id: 4
      name: inject-cpu-fault
      type: test
      action: start
      service:
        name: fault-service-C
        interface: fault-inject
      args:
        target: cxt.sprout
        fault:
          type: cpu-stress
          time: 5min

    -
      id: 5
      name: collect-experiment-data
      type: test
      action: start
      service:
        name: data-collect-service-D
        interface: collect-data
      args:
        from: cxt.hosts.host1
        to: cxt.hosts.host2


  flows:
    -
      name: main
      orders:
        -
          type: normal
          step: 1
        -
          type: normal
          step: 2
        -
          type: normal
          step: 3
        -
          type: normal
          step: 4
        -
          type: normal
          step: 5

  context:
    dir: abc_conf.yaml